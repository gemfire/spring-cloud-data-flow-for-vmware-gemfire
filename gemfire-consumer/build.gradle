plugins {
    id 'java-library'
    id 'idea'
    id 'eclipse'
    id "io.freefair.lombok" version "8.0.1"
    id "io.spring.dependency-management"
}

group = 'com.vmware.gemfire'
version = '1.0-SNAPSHOT'


sourceCompatibility = JavaVersion.VERSION_17
targetCompatibility = JavaVersion.VERSION_17

dependencyManagement {
    imports {
        mavenBom("org.springframework.boot:spring-boot-dependencies:${springBootVersion}")
        mavenBom("org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}")
    }
}

dependencies {

    implementation project(':gemfire-common')
    implementation ("com.vmware.gemfire:spring-data-3.0-gemfire-10.0:$springDataGemFire") {
        exclude group: "org.springframework"
        exclude module: "shiro-event"
        exclude module: "shiro-lang"
        exclude module: "shiro-crypto-hash"
        exclude module: "shiro-crypto-cipher"
        exclude module: "shiro-config-ogdl"
        exclude module: "shiro-config-core"
        exclude module: "shiro-cache"
        exclude module: "commons-logging"
    }
    compileOnly("com.vmware.gemfire:gemfire-core:$gemfireVersion") {
        exclude module: "commons-logging"
    }
    compileOnly("com.vmware.gemfire:gemfire-cq:$gemfireVersion")

    implementation 'org.json:json:20200518'
    implementation "com.vmware.gemfire:spring-integration-6.1-gemfire-10.0:${springIntegrationGemFire}"

    implementation "com.vmware.gemfire:spring-boot-3.0-gemfire-10.0:${springBootGemFire}"
    implementation "com.vmware.gemfire:spring-boot-logging-3.0-gemfire-10.0:${springBootGemFire}"
    implementation 'org.projectlombok:lombok:1.18.28'

    implementation 'javax.validation:validation-api:2.0.1.Final'
    implementation 'org.hibernate:hibernate-validator:6.2.5.Final'

    testImplementation 'com.fasterxml.jackson.core:jackson-databind:2.14.2'

    testImplementation("com.vmware.gemfire:gemfire-core:$gemfireVersion") {
        exclude module: "commons-logging"
    }
    testImplementation("com.vmware.gemfire:gemfire-cq:$gemfireVersion")
    testImplementation "org.springframework.boot:spring-boot-starter-test:${springBootVersion}"

    testImplementation platform('org.junit:junit-bom:5.9.1')
    testImplementation 'org.junit.jupiter:junit-jupiter'
    testImplementation 'com.vmware.gemfire:gemfire-testcontainers:1.0'
}

test {
    useJUnitPlatform()
}

repositories {
    mavenCentral()
    mavenLocal()
    maven {
        credentials {
            username "$gemfireRepoUsername"
            password "$gemfireRepoPassword"
        }
        url = uri("https://commercial-repo.pivotal.io/data3/gemfire-release-repo/gemfire")
    }
    def additionalMavenRepoURLs = project.ext.find('additionalMavenRepoURLs')
    if (additionalMavenRepoURLs != null && !additionalMavenRepoURLs.isEmpty() && !additionalMavenRepoURLs.isBlank()) {
        additionalMavenRepoURLs.split(',').each {
            project.getRepositories()
                    .maven(mavenRepository -> {
                        mavenRepository.setUrl(uri(it.toString()))
                    })
        }
    }
}
